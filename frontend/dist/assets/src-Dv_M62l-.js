import"./script-CsKhtSI9.js";function f(t){for(let e=0;e<10;e++)for(let o=0;o<10;o++){let a=document.createElement("div");a.classList.add(`row-${e}`),a.classList.add(`col-${o}`),t.appendChild(a)}}function u(t,e,o){const a={"-1":"",0:"0",1:"1",2:"2",3:"3",4:"4",5:"5",x:"x"};if(o)for(let r=0;r<10;r++)for(let s=0;s<10;s++){let n=e.querySelector(`.row-${r}.col-${s}`);a[t[r][s]]!=""&&a[t[r][s]]!="0"&&a[t[r][s]]!="x"||(a[t[r][s]]=="0"?n.style.background="lightblue":a[t[r][s]]=="x"&&(n.style.background="#ff2c2c",n.style.border="2px solid #640000"))}else for(let r=0;r<10;r++)for(let s=0;s<10;s++){let n=e.querySelector(`.row-${r}.col-${s}`);a[t[r][s]]!=""&&a[t[r][s]]!="0"&&a[t[r][s]]!="x"?(n.style.background="lightgreen",n.style.border="2px solid #0d570d"):a[t[r][s]]=="0"?n.style.background="lightblue":a[t[r][s]]=="x"&&(n.style.background="red",n.style.border="2px solid #640000")}}function m(t){document.querySelector(`#${t}`).style.display="none"}function b(t){t==!1&&(document.querySelector(".battle-button").disabled=!1,h("Commence the battle"))}function g(){document.querySelector(".battle-button").disabled=!0}function h(t){const e=document.querySelector(".notice h1");e.textContent=`${t}`}class y{constructor(e){this.length=e,this.damage=0}hit(e){this.damage+=e,this.isSunk()}isSunk(){return this.damage>=this.length?(console.log("Ship has sunk"),!0):!1}}class v{constructor(e,o=!1){this.board=this.createBoard(),this.ships={},this.boardUi=e,this.shipCount=0,this.computer=o}createBoard(){let e=[];for(let o=0;o<10;o++){let a=[];for(let r=0;r<10;r++)a.push("-1");e.push(a)}return e}placeShip(e,o,a){if(this.shipCount==5)return!1;for(let s=0;s<a;s++)if(this.board[e][o+s]!="-1")return console.log("Space is Occupied. Ship can't be deployed"),!1;let r=new y(a);this.shipCount+=1,this.ships[this.shipCount]=r;for(let s=0;s<a;s++)this.board[e][o+s]=""+this.shipCount;return u(this.board,this.boardUi,this.computer),this.shipCount==5&&b(this.computer),!0}receiveAttack(e,o){let a=this.board[e][o];if(a=="0"||a=="x")return!1;if(a=="-1")this.board[e][o]="0";else{let r=this.ships[this.board[e][o]];r.hit(1),r.isSunk()&&delete this.ships[this.board[e][o]],this.board[e][o]="x"}return u(this.board,this.boardUi,this.computer),!0}}class p{constructor(e,o=!0){this.computer=o,this.gameboard=new v(e,o)}randomMove(){const e=Math.floor(Math.random()*10),o=Math.floor(Math.random()*10);return{row:e,col:o}}randomPlacement(e){let o=Math.floor(Math.random()*10),a=Math.floor(Math.random()*10);for(;this.gameboard.placeShip(o,a,e)!=!0;)o=Math.floor(Math.random()*10),a=Math.floor(Math.random()*10)}isDefeated(){if(Object.keys(this.gameboard.ships).length==0)return!0}}const d=document.querySelector(".player1"),c=new p(d,!1),l=document.querySelector(".player2"),i=new p(l);f(d);f(l);i.randomPlacement(2);i.randomPlacement(2);i.randomPlacement(3);i.randomPlacement(4);i.randomPlacement(5);l.addEventListener("click",t=>{const e=t.target.classList,o=+e[0][e[0].length-1],a=+e[1][e[1].length-1];if(i.gameboard.board[o][a]=="0"||i.gameboard.receiveAttack(o,a)==!1)return;if(i.isDefeated()){console.log("Player 2 is defeated"),h("You are the Winner!!"),l.style.pointerEvents="none";return}let r=i.randomMove();for(;c.gameboard.board[r.row][r.col]=="0"||c.gameboard.board[r.row][r.col]=="x";)r=i.randomMove();if(c.gameboard.receiveAttack(r.row,r.col),c.isDefeated()){console.log("Player 1 is defeated"),h("Computer Wins. You have Lost (ToT)"),l.style.pointerEvents="none";return}});document.querySelectorAll(".ship").forEach(t=>{t.addEventListener("dragstart",e=>{e.dataTransfer.setData("text/plain",e.target.id)}),t.addEventListener("dragend",e=>{})});d.addEventListener("dragover",t=>{t.dataTransfer.types.includes("text/plain")&&t.preventDefault()});d.addEventListener("dragenter",t=>{t.target.classList.add("hovered")});d.addEventListener("dragleave",t=>{t.target.classList.remove("hovered")});d.addEventListener("drop",t=>{t.preventDefault(),t.target.classList.remove("hovered");const e=t.dataTransfer.getData("text/plain"),o=t.target.classList,a=+o[0][o[0].length-1],r=+o[1][o[1].length-1],s=document.querySelector(`#${e}`).childElementCount;c.gameboard.placeShip(a,r,s)&&m(e)});let S=document.querySelector(".battle-button");S.addEventListener("click",()=>{l.style.pointerEvents="auto",g(),h("Fight!")});
